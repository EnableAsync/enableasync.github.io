<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Kind çš„ä¸€äº›ä½¿ç”¨å¿ƒå¾—</title>
    <url>/uncategorized/kind/</url>
    <content><![CDATA[<h1 id="Kind-çš„ä¸€äº›ä½¿ç”¨å¿ƒå¾—"><a href="#Kind-çš„ä¸€äº›ä½¿ç”¨å¿ƒå¾—" class="headerlink" title="Kind çš„ä¸€äº›ä½¿ç”¨å¿ƒå¾—"></a>Kind çš„ä¸€äº›ä½¿ç”¨å¿ƒå¾—</h1><p>å› ä¸º Kind å¯åŠ¨ç›¸æ¯”äº Minikube æ›´å¿«ï¼Œè€Œä¸”æ”¯æŒå¤š Nodeï¼Œæ‰€ä»¥ç°åœ¨æ¢æˆäº† Kindï¼Œè¿™é‡Œè®°å½•ä¸€äº› Kind çš„ä½¿ç”¨å¿ƒå¾—ã€‚</p>
<h2 id="1-Kind-å®‰è£…"><a href="#1-Kind-å®‰è£…" class="headerlink" title="1. Kind å®‰è£…"></a>1. Kind å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.11.1/kind-linux-amd64<br>chmod +x ./kind<br>mv ./kind /usr/bin/kind<br></code></pre></td></tr></table></figure>
<h2 id="2-ä½¿ç”¨-Kind-åˆ›å»ºå«æœ‰ä¸¤ä¸ª-Node-çš„-kubernetes-é›†ç¾¤"><a href="#2-ä½¿ç”¨-Kind-åˆ›å»ºå«æœ‰ä¸¤ä¸ª-Node-çš„-kubernetes-é›†ç¾¤" class="headerlink" title="2. ä½¿ç”¨ Kind åˆ›å»ºå«æœ‰ä¸¤ä¸ª Node çš„ kubernetes é›†ç¾¤"></a>2. ä½¿ç”¨ Kind åˆ›å»ºå«æœ‰ä¸¤ä¸ª Node çš„ kubernetes é›†ç¾¤</h2><h3 id="1-åˆ›å»ºé…ç½®æ–‡ä»¶"><a href="#1-åˆ›å»ºé…ç½®æ–‡ä»¶" class="headerlink" title="1. åˆ›å»ºé…ç½®æ–‡ä»¶"></a>1. åˆ›å»ºé…ç½®æ–‡ä»¶</h3><p>è¿™é‡Œæˆ‘åˆ›å»ºäº†ä¸¤ä¸ª Nodeï¼Œä½¿ç”¨ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å…¶å‘½åä¸º <code>kind.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># a cluster with 1 control-plane nodes and 2 workers</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Cluster</span><br><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">kind.x-k8s.io/v1alpha4</span><br><span class="hljs-attr">nodes:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">role:</span> <span class="hljs-string">control-plane</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">role:</span> <span class="hljs-string">worker</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">role:</span> <span class="hljs-string">worker</span><br></code></pre></td></tr></table></figure>
<h3 id="2-åˆ›å»ºé›†ç¾¤"><a href="#2-åˆ›å»ºé›†ç¾¤" class="headerlink" title="2. åˆ›å»ºé›†ç¾¤"></a>2. åˆ›å»ºé›†ç¾¤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sudo kind create cluster --config kind.yaml<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ç‚¹æœ‰ï¼š</p>
<ol>
<li>ä¸è¦è®¾ç½®é›†ç¾¤ nameï¼Œåœ¨æˆ‘æœ¬åœ°ï¼Œå¦‚æœè®¾ç½®äº† name ä¼šå¯¼è‡´ kubeconfig æ— æ³•å¯¼å‡ºã€‚</li>
<li>è¦ä½¿ç”¨ sudoï¼Œåœ¨æˆ‘æœ¬åœ°ï¼Œå¦‚æœä¸ä½¿ç”¨ sudo ä¼šå¯¼è‡´æ— æ³•åˆ›å»ºé›†ç¾¤ï¼ŒåŸå› æœªçŸ¥ã€‚</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">Creating cluster <span class="hljs-string">&quot;kind&quot;</span> ...<br> âœ“ Ensuring node image (kindest/node:v1.21.1) ğŸ–¼<br> âœ“ Preparing nodes ğŸ“¦ ğŸ“¦ ğŸ“¦  <br> âœ“ Writing configuration ğŸ“œ <br> âœ“ Starting control-plane ğŸ•¹ï¸ <br> âœ“ Installing CNI ğŸ”Œ <br> âœ“ Installing StorageClass ğŸ’¾ <br> âœ“ Joining worker nodes ğŸšœ <br>Set kubectl context to <span class="hljs-string">&quot;kind-kind&quot;</span><br>You can now use your cluster with:<br><br>kubectl cluster-info --context kind-kind<br></code></pre></td></tr></table></figure>
<p>å¦‚æœå‡ºç°ä»¥ä¸Šä¿¡æ¯è¡¨ç¤ºåˆ›å»ºæˆåŠŸï¼Œå¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p>
<h3 id="3-å¯¼å‡º-kubeconfig"><a href="#3-å¯¼å‡º-kubeconfig" class="headerlink" title="3. å¯¼å‡º kubeconfig"></a>3. å¯¼å‡º kubeconfig</h3><figure class="highlight shell"><table><tr><td class="code"><pre><code class="hljs shell">kind export kubeconfig<br></code></pre></td></tr></table></figure>
<p>å¦‚æœä¸ä½¿ç”¨è¿™ä¸€æ­¥ï¼Œä¼šå¯¼è‡´ä½¿ç”¨ <code>kubectl</code> çš„æ—¶å€™å¿…é¡»åŠ ä¸Š <code>sudo</code>ï¼Œå¦åˆ™æ— æ³•è¿æ¥åˆ° kubernetesã€‚</p>
<h2 id="3-å®‰è£…-kubernetes-dashboard"><a href="#3-å®‰è£…-kubernetes-dashboard" class="headerlink" title="3. å®‰è£… kubernetes-dashboard"></a>3. å®‰è£… kubernetes-dashboard</h2><h3 id="1-ä½¿ç”¨-helm-å®‰è£…-dashboard"><a href="#1-ä½¿ç”¨-helm-å®‰è£…-dashboard" class="headerlink" title="1. ä½¿ç”¨ helm å®‰è£… dashboard"></a>1. ä½¿ç”¨ helm å®‰è£… dashboard</h3><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Add kubernetes-dashboard repository</span><br>helm repo add kubernetes-dashboard https://kubernetes.github.io/dashboard/<br><span class="hljs-comment"># Deploy a Helm Release named &quot;dashboard&quot; using the kubernetes-dashboard chart</span><br>helm install dashboard kubernetes-dashboard/kubernetes-dashboard<br></code></pre></td></tr></table></figure>
<h3 id="2-è½¬å‘-dashboard-pod"><a href="#2-è½¬å‘-dashboard-pod" class="headerlink" title="2. è½¬å‘ dashboard pod"></a>2. è½¬å‘ dashboard pod</h3><p>è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯åœ¨æœ¬åœ°è®¿é—®éƒ¨ç½²äº† dashboard çš„ pod</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> POD_NAME=$(kubectl get pods -n default -l <span class="hljs-string">&quot;app.kubernetes.io/name=kubernetes-dashboard,app.kubernetes.io/instance=dashboard&quot;</span> -o jsonpath=<span class="hljs-string">&quot;&#123;.items[0].metadata.name&#125;&quot;</span>)<br>  <span class="hljs-built_in">echo</span> https://127.0.0.1:8443/<br>  kubectl -n default port-forward <span class="hljs-variable">$POD_NAME</span> 8443:8443<br></code></pre></td></tr></table></figure>
<p>ä¹‹åä¼šæç¤º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">Forwarding from 127.0.0.1:8443 -&gt; 8443<br>Forwarding from [::1]:8443 -&gt; 8443<br></code></pre></td></tr></table></figure>
<p>è¯´æ˜è½¬å‘æˆåŠŸï¼Œæ­¤æ—¶è®¿é—® <a href="https://127.0.0.1:8443/">https://127.0.0.1:8443/</a> ï¼Œæ³¨æ„æ˜¯ https</p>
<h3 id="3-ç”Ÿæˆ-token"><a href="#3-ç”Ÿæˆ-token" class="headerlink" title="3. ç”Ÿæˆ token"></a>3. ç”Ÿæˆ token</h3><p>ä¸å‡ºæ„å¤– dashboard éœ€è¦ token æ¥ç™»å½•ï¼Œä½¿ç”¨ä»¥ä¸‹æ­¥éª¤æ¥ç”Ÿæˆ tokenï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">kubectl create serviceaccount dashboard -n default<br>kubectl create rolebinding def-ns-admin --clusterrole=admin --serviceaccount=default:def-ns-admin<br>kubectl create clusterrolebinding dashboard-cluster-admin --clusterrole=cluster-admin --serviceaccount=default:dashboard<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">kubectl describe sa dashboard<br>Name:                dashboard<br>Namespace:           default<br>Labels:              &lt;none&gt;<br>Annotations:         &lt;none&gt;<br>Image pull secrets:  &lt;none&gt;<br>Mountable secrets:   dashboard-token-vzzjn<br>Tokens:              dashboard-token-vzzjn<br>Events:              &lt;none&gt;<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ° <code>dashboard-token-vzzjn</code> å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ tokenï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ˜¾ç¤ºå…·ä½“å†…å®¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">kubectl describe secret dashboard-token-vzzjn<br></code></pre></td></tr></table></figure>
<p>ä¹‹åå°±å¯ä»¥å°†å…·ä½“çš„ token ç²˜è´´åœ¨ dashboard ä¸­ç™»å½•ã€‚</p>
]]></content>
      <tags>
        <tag>k8s, kind</tag>
      </tags>
  </entry>
  <entry>
    <title>ç®—æ³•æ•´ç†</title>
    <url>/uncategorized/leetcode/</url>
    <content><![CDATA[<h1 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h1><h2 id="æœ€é•¿å…¬å…±å­ä¸²"><a href="#æœ€é•¿å…¬å…±å­ä¸²" class="headerlink" title="æœ€é•¿å…¬å…±å­ä¸²"></a>æœ€é•¿å…¬å…±å­ä¸²</h2><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
d p[i][j]=\left\{\begin{array}{l}
d p[i-1][j-1]+1, \text { å½“ä¸”ä»…å½“ } x[i]=y[j] \\
0, \text { å½“ } x[i] \ne y[j]
\end{array}\right.</script><p>æŒ‰ç…§ä¸Šé¢æ–¹ç¨‹å®ç°çš„ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º $O(n^2)$ã€‚</p>
<p><img  src="../leetcode/d6f0b0e17ed6e13f5c042d172b1ddca782cb6aba589f5fcfea8944831614502f-image.png"  ><span class="image-caption">image.png</span></p>
<p>æ³¨æ„åˆ°ï¼Œæ›´æ–° $dp[i][j]$ åªéœ€è¦ä¸Šä¸€åˆ—ï¼Œå³ $dp[i-1]$ åˆ—ï¼Œæ‰€ä»¥å¯ä»¥å°†ç©ºé—´å¤æ‚åº¦é™ä½ä¸º $O(n)$ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„å› ä¸ºä½¿ç”¨çš„æ˜¯ç›¸åŒçš„æ•°ç»„åˆ—ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²ä¸ç›¸ç­‰æ—¶éœ€è¦è®¾ç½® $dp[j] = 0$ï¼ŒåŒæ—¶è¦æ³¨æ„ä»åå‘å‰æ›´æ–°æ•°ç»„ï¼Œå› ä¸ºå¦‚æœä»å‰å‘åæ›´æ–°ï¼Œé‚£ä¹ˆå½“å‰çš„ $dp[j]$ ä½¿ç”¨çš„æ˜¯å½“å‰åˆ—åˆšåˆšæ›´æ–°è¿‡çš„æ•°æ®ï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸Šä¸€åˆ—çš„æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥ä»åå‘å‰æ›´æ–°æ•°æ®é¿å…è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>rust ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> dp = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>; s2.len()];<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..s1.len() &#123;<br>    <span class="hljs-comment">// é€†åºè¿­ä»£æ˜¯å› ä¸ºæ›´æ–°a[i][j]éœ€è¦a[i-1][j-1]</span><br>    <span class="hljs-comment">// ç°åœ¨æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ a[j] æ˜¯åŸæ¥çš„ a[i][j]ï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ a[i-1][j]</span><br>    <span class="hljs-comment">// æ‰€ä»¥ä»åå‘å‰è¿­ä»£ï¼Œa[j] æ˜¯åŸæ¥çš„ a[i-1][j]</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> (<span class="hljs-number">0</span>..s2.len()).s2() &#123;<br>        <span class="hljs-keyword">if</span> s[i] == s2[j] &#123;<br>            <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> || j == <span class="hljs-number">0</span> &#123;<br>                dp[j] = <span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                dp[j] = dp[j - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span> dp[j] &gt; max_len &#123;<br>                <span class="hljs-keyword">let</span> before_s2 = s2.len() - <span class="hljs-number">1</span> - j;<br>                <span class="hljs-keyword">if</span> before_s2 + dp[j] - <span class="hljs-number">1</span> == i &#123;<br>                    max_len = dp[j];<br>                    max_end = i;<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// ä¸ä¹‹å‰ä¸åŒï¼Œä¹‹å‰ä½¿ç”¨çš„æ˜¯ä¸åŒçš„åˆ—ï¼Œæ‰€ä»¥ä¸éœ€è¦ç½®0</span><br>            dp[j] = <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="æœ€é•¿å›æ–‡å­ä¸²"><a href="#æœ€é•¿å›æ–‡å­ä¸²" class="headerlink" title="æœ€é•¿å›æ–‡å­ä¸²"></a>æœ€é•¿å›æ–‡å­ä¸²</h2><h3 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h3><p>å°†å­—ç¬¦ä¸²å€’ç½®ä¹‹åæ±‚æœ€é•¿å…¬å…±å­ä¸²ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦ä¸ºå›æ–‡å­ä¸²ï¼Œè¿™é‡Œå›æ–‡å­ä¸²ã€Œç”±å€’ç½®å­—ç¬¦ä¸²æ¨å‡ºçš„åŸå­—ç¬¦ä¸²æœ«å°¾ä¸‹æ ‡ã€ä¸ã€Œiã€åº”è¯¥ç›¸ç­‰ã€‚</p>
<p>ä»£ç ä¸­ <code>longest_palindrome1</code> çš„æ±‚æœ€é•¿å…¬å…±å­ä¸²ç©ºé—´å¤æ‚åº¦ä¸º $O(n^2)$ï¼Œ<code>longest_palindrome2</code> çš„æ±‚æœ€é•¿å…¬å…±å­ä¸²ç©ºé—´å¤æ‚åº¦ä¸º $O(n)$ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Solution</span></span>;<br><br><span class="hljs-keyword">impl</span> Solution &#123;<br>    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">longest_palindrome1</span></span>(s: <span class="hljs-built_in">String</span>) -&gt; <span class="hljs-built_in">String</span> &#123;<br>        <span class="hljs-keyword">if</span> s.len() &lt;= <span class="hljs-number">1</span> &#123;<br>            <span class="hljs-keyword">return</span> s;<br>        &#125;<br>        <span class="hljs-keyword">let</span> rev: <span class="hljs-built_in">String</span> = s.chars().rev().collect();<br>        <span class="hljs-keyword">let</span> rev = rev.as_bytes();<br>        <span class="hljs-keyword">let</span> s = s.as_bytes();<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> dp = <span class="hljs-built_in">vec!</span>[<span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>; rev.len()]; s.len()];<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> max_len = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> max_end = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..s.len() &#123;<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..rev.len() &#123;<br>                <span class="hljs-keyword">if</span> s[i] == rev[j] &#123;<br>                    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> || j == <span class="hljs-number">0</span> &#123;<br>                        dp[i][j] = <span class="hljs-number">1</span>;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;<br>                    &#125;<br>                &#125;<br>                <span class="hljs-keyword">if</span> dp[i][j] &gt; max_len &#123;<br>                    <span class="hljs-comment">// å¦‚æœæ˜¯å›æ–‡ä¸²ï¼Œé‚£ä¹ˆã€Œç”±å€’ç½®å­—ç¬¦ä¸²æ¨å‡ºçš„åŸå­—ç¬¦ä¸²æœ«å°¾ä¸‹æ ‡ã€ä¸ã€Œiã€åº”è¯¥ç›¸ç­‰</span><br>                    <span class="hljs-comment">// å…¶ä¸­ï¼Œå€’ç½®å­—ç¬¦ä¸²çš„ rev.len() - 1 - jï¼Œä¹Ÿå°±æ˜¯å€’ç½®ä¹‹å‰çš„å¼€å§‹ä¸‹æ ‡ï¼Œå‡ä¸€æ˜¯å› ä¸ºé•¿åº¦æ¯”ä¸‹æ ‡å¤šä¸€</span><br>                    <span class="hljs-comment">// å†åŠ ä¸Š dp[i][j] - 1ï¼Œå°±æ˜¯åŸå­—ç¬¦ä¸²çš„æœ«å°¾ä¸‹æ ‡ã€‚abcï¼Œaçš„ä¸‹æ ‡ä¸º0ï¼Œé•¿åº¦ä¸º3ï¼Œ0+3ä¸º3ï¼Œä½†æ˜¯æœ€å¤§ä¸‹æ ‡ä¸º2ï¼Œæ‰€ä»¥éœ€è¦å‡ä¸€</span><br>                    <span class="hljs-keyword">let</span> before_rev = rev.len() - <span class="hljs-number">1</span> - j;<br>                    <span class="hljs-keyword">if</span> before_rev + dp[i][j] - <span class="hljs-number">1</span> == i &#123;<br>                        max_len = dp[i][j];<br>                        max_end = i;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>        std::<span class="hljs-built_in">str</span>::from_utf8(&amp;s[max_end + <span class="hljs-number">1</span> - max_len..max_end + <span class="hljs-number">1</span>])<br>            .unwrap()<br>            .to_string()<br>    &#125;<br>    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">longest_palindrome2</span></span>(s: <span class="hljs-built_in">String</span>) -&gt; <span class="hljs-built_in">String</span> &#123;<br>        <span class="hljs-keyword">if</span> s.len() &lt; <span class="hljs-number">1</span> &#123;<br>            <span class="hljs-keyword">return</span> s;<br>        &#125;<br>        <span class="hljs-keyword">let</span> rev: <span class="hljs-built_in">String</span> = s.chars().rev().collect();<br>        <span class="hljs-keyword">let</span> s = s.as_bytes();<br>        <span class="hljs-keyword">let</span> rev = rev.as_bytes();<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> max_len = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> max_end = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> dp = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>; rev.len()];<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..s.len() &#123;<br>            <span class="hljs-comment">// é€†åºè¿­ä»£æ˜¯å› ä¸ºæ›´æ–°a[i][j]éœ€è¦a[i-1][j-1]</span><br>            <span class="hljs-comment">// ç°åœ¨æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ a[j] æ˜¯åŸæ¥çš„ a[i][j]ï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ a[i-1][j]</span><br>            <span class="hljs-comment">// æ‰€ä»¥ä»åå‘å‰è¿­ä»£ï¼Œa[j] æ˜¯åŸæ¥çš„ a[i-1][j]</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> (<span class="hljs-number">0</span>..rev.len()).rev() &#123;<br>                <span class="hljs-keyword">if</span> s[i] == rev[j] &#123;<br>                    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> || j == <span class="hljs-number">0</span> &#123;<br>                        dp[j] = <span class="hljs-number">1</span>;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        dp[j] = dp[j - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> dp[j] &gt; max_len &#123;<br>                        <span class="hljs-keyword">let</span> before_rev = rev.len() - <span class="hljs-number">1</span> - j;<br>                        <span class="hljs-keyword">if</span> before_rev + dp[j] - <span class="hljs-number">1</span> == i &#123;<br>                            max_len = dp[j];<br>                            max_end = i;<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// ä¸ä¹‹å‰ä¸åŒï¼Œä¹‹å‰ä½¿ç”¨çš„æ˜¯ä¸åŒçš„åˆ—ï¼Œæ‰€ä»¥ä¸éœ€è¦ç½®0</span><br>                    dp[j] = <span class="hljs-number">0</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        std::<span class="hljs-built_in">str</span>::from_utf8(&amp;s[max_end + <span class="hljs-number">1</span> - max_len..max_end + <span class="hljs-number">1</span>])<br>            .unwrap()<br>            .to_string()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="ä¸­å¿ƒæ‹“å±•ç®—æ³•"><a href="#ä¸­å¿ƒæ‹“å±•ç®—æ³•" class="headerlink" title="ä¸­å¿ƒæ‹“å±•ç®—æ³•"></a>ä¸­å¿ƒæ‹“å±•ç®—æ³•</h3><p>ä¸ºäº†é¿å…åœ¨ä¹‹åçš„å™è¿°ä¸­å‡ºç°æ­§ä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬æŒ‡å‡ºä»€ä¹ˆæ˜¯â€œæœ´ç´ ç®—æ³•â€ã€‚</p>
<p>è¯¥ç®—æ³•é€šè¿‡ä¸‹è¿°æ–¹å¼å·¥ä½œï¼šå¯¹æ¯ä¸ªä¸­å¿ƒä½ç½® $i$ åœ¨æ¯”è¾ƒä¸€å¯¹å¯¹åº”å­—ç¬¦åï¼Œåªè¦å¯èƒ½ï¼Œè¯¥ç®—æ³•ä¾¿å°è¯•å°†ç­”æ¡ˆåŠ  $1$ã€‚</p>
<p>è¯¥ç®—æ³•æ˜¯æ¯”è¾ƒæ…¢çš„ï¼šå®ƒåªèƒ½åœ¨ $O(n^2)$ çš„æ—¶é—´å†…è®¡ç®—ç­”æ¡ˆã€‚</p>
<p>è¯¥ç®—æ³•çš„å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// C++ Version</span><br><span class="hljs-function">vector&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">d1</span><span class="hljs-params">(n)</span>, <span class="hljs-title">d2</span><span class="hljs-params">(n)</span></span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>  d1[i] = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">while</span> (<span class="hljs-number">0</span> &lt;= i - d1[i] &amp;&amp; i + d1[i] &lt; n &amp;&amp; s[i - d1[i]] == s[i + d1[i]]) &#123;<br>    d1[i]++;<br>  &#125;<br><br>  d2[i] = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> (<span class="hljs-number">0</span> &lt;= i - d2[i] - <span class="hljs-number">1</span> &amp;&amp; i + d2[i] &lt; n &amp;&amp;<br>         s[i - d2[i] - <span class="hljs-number">1</span>] == s[i + d2[i]]) &#123;<br>    d2[i]++;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Python Version</span><br>d1 = [<span class="hljs-number">0</span>] * n<br>d2 = [<span class="hljs-number">0</span>] * n<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, n):<br>    d1[i] = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">0</span> &lt;= i - d1[i] <span class="hljs-keyword">and</span> i + d1[i] &lt; n <span class="hljs-keyword">and</span> s[i - d1[i]] == s[i + d1[i]]:<br>        d1[i] += <span class="hljs-number">1</span><br><br>    d2[i] = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">0</span> &lt;= i - d2[i] - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> i + d2[i] &lt; n <span class="hljs-keyword">and</span> s[i - d2[i] - <span class="hljs-number">1</span>] == s[i + d2[i]]:<br>        d2[i] += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<h3 id="Manacher-ç®—æ³•12"><a href="#Manacher-ç®—æ³•12" class="headerlink" title="Manacher ç®—æ³•12"></a>Manacher ç®—æ³•<sup><a href="#fn_1" id="reffn_1">1</a></sup><sup><a href="#fn_2" id="reffn_2">2</a></sup></h3><p>Manacher ç®—æ³•æ˜¯å¯¹ä¸­å¿ƒæ‹“å±•ç®—æ³•çš„ä¼˜åŒ–ï¼Œä¸ºäº†å¿«é€Ÿè®¡ç®—ï¼Œæˆ‘ä»¬ç»´æŠ¤å·²æ‰¾åˆ°çš„æœ€é å³çš„å­å›æ–‡ä¸²çš„ <strong>è¾¹ç•Œ $(l, r)$</strong>ï¼ˆå³å…·æœ‰æœ€å¤§ $r$ å€¼çš„å›æ–‡ä¸²ï¼Œå…¶ä¸­ $l$ å’Œ $r$ åˆ†åˆ«ä¸ºè¯¥å›æ–‡ä¸²å·¦å³è¾¹ç•Œçš„ä½ç½®ï¼‰ã€‚åˆå§‹æ—¶ï¼Œæˆ‘ä»¬ç½® $l = 0$ å’Œ $r = -1$ï¼ˆ<em>-1</em>éœ€åŒºåˆ«äºå€’åºç´¢å¼•ä½ç½®ï¼Œè¿™é‡Œå¯ä¸ºä»»æ„è´Ÿæ•°ï¼Œä»…ä¸ºäº†å¾ªç¯åˆå§‹æ—¶æ–¹ä¾¿ï¼‰ã€‚</p>
<p>ç°åœ¨å‡è®¾æˆ‘ä»¬è¦å¯¹ä¸‹ä¸€ä¸ª $i$ è®¡ç®— $P[i]$ï¼Œè€Œä¹‹å‰æ‰€æœ‰ $P[]$ ä¸­çš„å€¼å·²è®¡ç®—å®Œæ¯•ã€‚æˆ‘ä»¬å°†é€šè¿‡ä¸‹åˆ—æ–¹å¼è®¡ç®—ï¼š</p>
<ul>
<li><p>å¦‚æœ $i$ ä½äºå½“å‰å­å›æ–‡ä¸²ä¹‹å¤–ï¼Œå³ $i &gt; r$ï¼Œé‚£ä¹ˆæˆ‘ä»¬è°ƒç”¨æœ´ç´ ç®—æ³•ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬å°†è¿ç»­åœ°å¢åŠ  $d_1[i]$ï¼ŒåŒæ—¶åœ¨æ¯ä¸€æ­¥ä¸­æ£€æŸ¥å½“å‰çš„å­ä¸² $[i - P[i] \dots i +  P[i]]$ï¼ˆ$P[i]$ è¡¨ç¤ºåŠå¾„é•¿åº¦ï¼Œä¸‹åŒï¼‰æ˜¯å¦ä¸ºä¸€ä¸ªå›æ–‡ä¸²ã€‚å¦‚æœæˆ‘ä»¬æ‰¾åˆ°äº†ç¬¬ä¸€å¤„å¯¹åº”å­—ç¬¦ä¸åŒï¼Œåˆæˆ–è€…ç¢°åˆ°äº† $s$  çš„è¾¹ç•Œï¼Œåˆ™ç®—æ³•åœæ­¢ã€‚åœ¨ä¸¤ç§æƒ…å†µä¸‹æˆ‘ä»¬å‡å·²è®¡ç®—å®Œ $P[i]$ã€‚æ­¤åï¼Œä»éœ€è®°å¾—æ›´æ–° $(l, r)$ã€‚</p>
</li>
<li><p>ç°åœ¨è€ƒè™‘ $i \le r$ çš„æƒ…å†µã€‚æˆ‘ä»¬å°†å°è¯•ä»å·²è®¡ç®—è¿‡çš„ $P[]$ çš„å€¼ä¸­è·å–ä¸€äº›ä¿¡æ¯ã€‚é¦–å…ˆåœ¨å­å›æ–‡ä¸²  $(l, r)$ ä¸­åè½¬ä½ç½® $i$ï¼Œå³æˆ‘ä»¬å¾—åˆ° $j = l + (r - i)$ã€‚ç°åœ¨æ¥è€ƒå¯Ÿå€¼ $P[j]$ã€‚å› ä¸ºä½ç½® $j$ åŒä½ç½®  $i$ å¯¹ç§°ï¼Œæˆ‘ä»¬ <strong>å‡ ä¹æ€»æ˜¯</strong> å¯ä»¥ç½® $P[i] = P[j]$ã€‚</p>
<p>å­˜åœ¨ <strong>æ£˜æ‰‹çš„æƒ…å†µ</strong>ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ï¼š</p>
<ul>
<li><p>è¶…å‡ºäº† $r$</p>
<p><img  src="../leetcode/b0d52a5f30747e55ef09b3c7b7cfc23026e37040edc41f387263e8f8a0ba8f49-image.png"  ><span class="image-caption">å›¾è½¬è‡ª LeetCode</span></p>
<p>å½“æˆ‘ä»¬è¦æ±‚ $P [ i ]$ çš„æ—¶å€™ï¼Œ$P [mirror] = 7$ï¼Œè€Œæ­¤æ—¶ $P [ i ]$ å¹¶ä¸ç­‰äº $7$ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºæˆ‘ä»¬ä» $i$ å¼€å§‹å¾€åæ•° $7$ ä¸ªï¼Œç­‰äº $22$ï¼Œå·²ç»è¶…è¿‡äº†æœ€å³çš„ $r$ï¼Œæ­¤æ—¶ä¸èƒ½åˆ©ç”¨å¯¹ç§°æ€§äº†ï¼Œä½†æˆ‘ä»¬ä¸€å®šå¯ä»¥æ‰©å±•åˆ° $r$ çš„ï¼Œæ‰€ä»¥ $P [ i ]$ è‡³å°‘ç­‰äº $r - i = 20 - 15 = 5$ï¼Œä¼šä¸ä¼šæ›´å¤§å‘¢ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒ $T [ r+1 ]$ å’Œ $T [ r+1 ]$ å…³äº $i$ çš„å¯¹ç§°ç‚¹å°±è¡Œäº†ï¼Œå°±åƒä¸­å¿ƒæ‰©å±•æ³•ä¸€æ ·ä¸€ä¸ªä¸ªæ‰©å±•ã€‚</p>
</li>
<li><p>$P[i]$ é‡åˆ°äº†åŸå­—ç¬¦ä¸²çš„å·¦è¾¹ç•Œ</p>
<p><img  src="../leetcode/714e6f768e67304fb7162ecac3ae85fcf23ad82a21456e8ca55ac2c8cfd2609e-image.png"  ><span class="image-caption">image.png</span></p>
<p>æ­¤æ—¶$P [ i<em>{mirror} ] = 1$ï¼Œä½†æ˜¯ $P [ i ]$ èµ‹å€¼æˆ 1 æ˜¯ä¸æ­£ç¡®çš„ï¼Œå‡ºç°è¿™ç§æƒ…å†µçš„åŸå› æ˜¯ $P [ i</em>{mirror} ]$ åœ¨æ‰©å±•çš„æ—¶å€™é¦–å…ˆæ˜¯ â€œ#â€ == â€œ#â€ï¼Œä¹‹åé‡åˆ°äº† â€œ^â€ å’Œå¦ä¸€ä¸ªå­—ç¬¦æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯åˆ°äº†è¾¹ç•Œï¼Œæ‰ç»ˆæ­¢å¾ªç¯çš„ã€‚è€Œ $P [ i ]$ å¹¶æ²¡æœ‰é‡åˆ°è¾¹ç•Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»§ç»­é€šè¿‡ä¸­å¿ƒæ‰©å±•æ³•ä¸€æ­¥ä¸€æ­¥å‘ä¸¤è¾¹æ‰©å±•å°±è¡Œäº†ã€‚</p>
</li>
<li><p>$i = r$</p>
<p>æ­¤æ—¶æˆ‘ä»¬å…ˆæŠŠ P [ i ] èµ‹å€¼ä¸º 0ï¼Œç„¶åé€šè¿‡ä¸­å¿ƒæ‰©å±•æ³•ä¸€æ­¥ä¸€æ­¥æ‰©å±•å°±è¡Œäº†ã€‚</p>
</li>
</ul>
<p>è€ƒè™‘ $r$ çš„æ›´æ–°</p>
<p>å°±è¿™æ ·ä¸€æ­¥ä¸€æ­¥çš„æ±‚å‡ºæ¯ä¸ª $P [ i ]$ï¼Œå½“æ±‚å‡ºçš„ $P [ i ]$ çš„å³è¾¹ç•Œå¤§äºå½“å‰çš„ $r$ æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦æ›´æ–° $r$ ä¸ºå½“å‰çš„å›æ–‡ä¸²äº†ã€‚</p>
</li>
</ul>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><blockquote id="fn_1">
<sup>1</sup>. <a href="https://leetcode-cn.com/problems/longest-palindromic-substring/solution/xiang-xi-tong-su-de-si-lu-fen-xi-duo-jie-fa-bao-gu">https://leetcode-cn.com/problems/longest-palindromic-substring/solution/xiang-xi-tong-su-de-si-lu-fen-xi-duo-jie-fa-bao-gu</a><a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_2">
<sup>2</sup>. <a href="https://oi-wiki.org/string/manacher/">https://oi-wiki.org/string/manacher/</a><a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a>
</blockquote>
]]></content>
      <tags>
        <tag>data structure, algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux çš„ä¸€äº›ä½¿ç”¨å¿ƒå¾—</title>
    <url>/linux/linux/</url>
    <content><![CDATA[<h1 id="æŒ‰æ—¶é—´é™åºæœ€è¿‘å®‰è£…çš„ç¨‹åº"><a href="#æŒ‰æ—¶é—´é™åºæœ€è¿‘å®‰è£…çš„ç¨‹åº" class="headerlink" title="æŒ‰æ—¶é—´é™åºæœ€è¿‘å®‰è£…çš„ç¨‹åº"></a>æŒ‰æ—¶é—´é™åºæœ€è¿‘å®‰è£…çš„ç¨‹åº</h1><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> $(ls -1t /var/<span class="hljs-built_in">log</span>/dpkg.log*); <span class="hljs-keyword">do</span> <br>      zcat -f <span class="hljs-variable">$x</span> |tac |grep -e <span class="hljs-string">&quot; install &quot;</span> -e <span class="hljs-string">&quot; upgrade &quot;</span>; <br><span class="hljs-keyword">done</span> | awk -F <span class="hljs-string">&quot;:a&quot;</span> <span class="hljs-string">&#x27;&#123;print $1 &quot; :a&quot; $2&#125;&#x27;</span> |column -t<br></code></pre></td></tr></table></figure>
<h1 id="å¸¸ç”¨çš„ä¸€äº›-gnome-extensions"><a href="#å¸¸ç”¨çš„ä¸€äº›-gnome-extensions" class="headerlink" title="å¸¸ç”¨çš„ä¸€äº› gnome extensions"></a>å¸¸ç”¨çš„ä¸€äº› gnome extensions</h1><h2 id="ddterm"><a href="#ddterm" class="headerlink" title="ddterm"></a>ddterm</h2><ul>
<li>æŒ‰ <code>F10</code> å¿«é€Ÿå¯åŠ¨å‘½ä»¤è¡Œï¼Œå†æŒ‰ <code>F10</code> éšè—ï¼Œååˆ†æ–¹ä¾¿</li>
</ul>
<h2 id="Desktop-Icons-NG-DING"><a href="#Desktop-Icons-NG-DING" class="headerlink" title="Desktop Icons NG(DING)"></a>Desktop Icons NG(DING)</h2><p>åœ¨æ¡Œé¢ä¸Šæ˜¾ç¤ºå›¾æ ‡</p>
<h2 id="Lock-Keys"><a href="#Lock-Keys" class="headerlink" title="Lock Keys"></a>Lock Keys</h2><p>å¯ä»¥æ˜¾ç¤ºå½“å‰å¤§å°å†™çŠ¶å†µ</p>
<h2 id="NetSpeed"><a href="#NetSpeed" class="headerlink" title="NetSpeed"></a>NetSpeed</h2><p>æ˜¾ç¤ºå½“å‰ç½‘é€Ÿ</p>
<h2 id="TopIcons-Plusï¼ˆåœ¨-gnome-40-ä¹‹åä½¿ç”¨-Ubuntu-Appindicators-æ›¿ä»£ï¼‰"><a href="#TopIcons-Plusï¼ˆåœ¨-gnome-40-ä¹‹åä½¿ç”¨-Ubuntu-Appindicators-æ›¿ä»£ï¼‰" class="headerlink" title="TopIcons Plusï¼ˆåœ¨ gnome 40 ä¹‹åä½¿ç”¨ Ubuntu Appindicators æ›¿ä»£ï¼‰"></a>TopIcons Plusï¼ˆåœ¨ gnome 40 ä¹‹åä½¿ç”¨ Ubuntu Appindicators æ›¿ä»£ï¼‰</h2><p>åœ¨é¡¶éƒ¨æ˜¾ç¤ºå›¾æ ‡</p>
<h2 id="Dash-to-Dock"><a href="#Dash-to-Dock" class="headerlink" title="Dash to Dock"></a>Dash to Dock</h2><p>åœ¨åº•éƒ¨æ™ºèƒ½æ˜¾ç¤ºä¸€ä¸ª Dock</p>
<h1 id="æ¢-MAC-åœ°å€"><a href="#æ¢-MAC-åœ°å€" class="headerlink" title="æ¢ MAC åœ°å€"></a>æ¢ MAC åœ°å€</h1><p>æœ‰çš„æ—¶å€™éœ€è¦æ›´æ¢ linux çš„ ip åœ°å€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sudo ifconfig eth0 down<br>sudo ifconfig wlo1 hw ether 02:42:41:7d:b7:6e<br>sudo ifconfig wlo1 up<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œ <code>eth0</code> æ˜¯ç½‘ç»œ interfaceï¼Œether ä¹‹åçš„å‚æ•°å°±æ˜¯ MAC åœ°å€</p>
<h1 id="è¾“å…¥æ³•"><a href="#è¾“å…¥æ³•" class="headerlink" title="è¾“å…¥æ³•"></a>è¾“å…¥æ³•</h1><h2 id="Fcitx-å¤±æ•ˆ"><a href="#Fcitx-å¤±æ•ˆ" class="headerlink" title="Fcitx å¤±æ•ˆ"></a>Fcitx å¤±æ•ˆ</h2><ol>
<li><p>ä½¿ç”¨ im-config ä¿®å¤</p>
</li>
<li><p>å¯èƒ½æ˜¯ fcitx æ²¡æœ‰æ­£å¸¸å¯åŠ¨ï¼Œå³è¿˜æ˜¯ ibusï¼Œå¯ä»¥ä¿®æ”¹ ~/.pam_environment</p>
</li>
<li><p>åˆ é™¤ /etc/profile.d/pop-im-ibus.sh</p>
<p><code>/etc/profile.d/pop-im-ibus.sh</code> ï¼ˆæºæ–‡ä»¶ï¼š /etc/gdm3/Xsession ï¼‰è®¾ç½®äº†ç¯å¢ƒå˜é‡ <code>XMODIFIERS</code> ï¼Œåœ¨ <code>/etc/X11/Xsession.d/70im-config_launch</code> ä¸­æœ‰å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$XMODIFIERS</span>&quot;</span> ] &amp;&amp; \  <span class="hljs-comment"># å¦‚æœç¯å¢ƒå˜é‡ XMODIFIERS æ²¡æœ‰è¢«è®¾ç½®</span><br>   ...<br>   <span class="hljs-comment"># è®¾ç½®ç¯å¢ƒå˜é‡ä»¥å¯åŠ¨ç”¨æˆ·æŒ‡å®šçš„è¾“å…¥æ³•</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure>
<p>å› ä¸º <code>XMODIFIERS</code> è¢«è®¾ç½®äº†ï¼Œæ‰€ä»¥ <code>è®¾ç½®ç¯å¢ƒå˜é‡ä»¥å¯åŠ¨ç”¨æˆ·æŒ‡å®šçš„è¾“å…¥æ³•</code> æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€ä»¥ fcitx æ²¡æœ‰è¢«å¯åŠ¨ã€‚</p>
<p><code>/etc/profile.d/pop-im-ibus.sh</code> ç¬¬ä¸€æ¬¡å‡ºç°äº <code>pop-os_20.10_amd64_intel_4.iso</code> ï¼ˆå‘å¸ƒäº 2020 å¹´ 12 æœˆä¸­æ—¬ï¼‰</p>
<p>ç›¸å…³ issueï¼Œ<a href="https://github.com/pop-os/pop/issues/1445">https://github.com/pop-os/pop/issues/1445</a></p>
</li>
</ol>
<h1 id="Dash-to-dock"><a href="#Dash-to-dock" class="headerlink" title="Dash to dock"></a>Dash to dock</h1><h2 id="Dash-to-dock-é‡å é—®é¢˜"><a href="#Dash-to-dock-é‡å é—®é¢˜" class="headerlink" title="Dash to dock é‡å é—®é¢˜"></a>Dash to dock é‡å é—®é¢˜</h2><p>   Pop os è‡ªå¸¦çš„ Dock ä¸ Dash to dock å‘ç”Ÿäº†é‡å </p>
   <figure class="highlight shell"><table><tr><td class="code"><pre><code class="hljs shell">cd /usr/share/gnome-shell/extensions<br>sudo mv cosmic-dock@system76.com cosmic-dock@system76.com.bak # å…³é—­è‡ªå¸¦çš„ dock<br></code></pre></td></tr></table></figure>
<p>   ä¹‹åé‡å¯ gnome å³å¯è§£å†³</p>
<h1 id="Alt-Tab-æ—¶é˜»æ­¢ç›¸åŒåº”ç”¨å åŠ "><a href="#Alt-Tab-æ—¶é˜»æ­¢ç›¸åŒåº”ç”¨å åŠ " class="headerlink" title="Alt + Tab æ—¶é˜»æ­¢ç›¸åŒåº”ç”¨å åŠ "></a>Alt + Tab æ—¶é˜»æ­¢ç›¸åŒåº”ç”¨å åŠ </h1><p>åœ¨ gnome è®¾ç½®ä¸­ï¼Œæ‰“å¼€ keyboard shortcutï¼Œå°† <code>Switch windows</code> è®¾ç½®ä¸º <code>Alt + Tab</code> ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„ <code>Switch applications</code>ã€‚</p>
<p>å‚è€ƒï¼š<a href="https://superuser.com/questions/394376/how-to-prevent-gnome-shells-alttab-from-grouping-windows-from-similar-apps">https://superuser.com/questions/394376/how-to-prevent-gnome-shells-alttab-from-grouping-windows-from-similar-apps</a></p>
<h1 id="fluxion"><a href="#fluxion" class="headerlink" title="fluxion"></a>fluxion</h1><h2 id="æ‰«æä¸åˆ°çƒ­ç‚¹"><a href="#æ‰«æä¸åˆ°çƒ­ç‚¹" class="headerlink" title="æ‰«æä¸åˆ°çƒ­ç‚¹"></a>æ‰«æä¸åˆ°çƒ­ç‚¹</h2><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sudo airmon-ng<br>sudo airmon-ng start fluxwl0<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> FLUXIONAirmonNG=1<br></code></pre></td></tr></table></figure>
<p>æ‰§è¡Œä¸Šè¿°å‘½ä»¤åå†è¿è¡Œ fluxion å³å¯ã€‚</p>
<h2 id="è§£é™¤-53-ç«¯å£è¢«-systemd-resolved-å ç”¨"><a href="#è§£é™¤-53-ç«¯å£è¢«-systemd-resolved-å ç”¨" class="headerlink" title="è§£é™¤ 53 ç«¯å£è¢« systemd-resolved å ç”¨"></a>è§£é™¤ 53 ç«¯å£è¢« systemd-resolved å ç”¨</h2><ol>
<li>å…ˆåœç”¨ systemd-resolved æœåŠ¡</li>
</ol>
<figure class="highlight arduino"><table><tr><td class="code"><pre><code class="hljs arduino">systemctl stop systemd-resolved<br></code></pre></td></tr></table></figure>
<ol>
<li>ç¼–è¾‘ /etc/systemd/resolved.conf æ–‡ä»¶</li>
</ol>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">vi <span class="hljs-regexp">/etc/</span>systemd/resolved.conf<br></code></pre></td></tr></table></figure>
<ol>
<li>æ¢ä¸‹é¢è¯´æ˜æ›´æ”¹ï¼Œç„¶åæŒ‰ä¸€ä¸‹â€œescâ€é”®ï¼Œå†è¾“å…¥â€œ:wqâ€ï¼ˆä¸è¦è¾“å…¥å¼•å·ï¼‰ï¼Œå›è½¦ä¿å­˜å³å¯ã€‚</li>
</ol>
<figure class="highlight ini"><table><tr><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Resolve]</span><br><span class="hljs-attr">DNS</span>=<span class="hljs-number">8.8</span>.<span class="hljs-number">8.8</span>  <span class="hljs-comment">#å–æ¶ˆæ³¨é‡Šï¼Œå¢åŠ dns</span><br><span class="hljs-comment">#FallbackDNS=</span><br><span class="hljs-comment">#Domains=</span><br><span class="hljs-comment">#LLMNR=no</span><br><span class="hljs-comment">#MulticastDNS=no</span><br><span class="hljs-comment">#DNSSEC=no</span><br><span class="hljs-comment">#Cache=yes</span><br><span class="hljs-attr">DNSStubListener</span>=<span class="hljs-literal">no</span>  <span class="hljs-comment">#å–æ¶ˆæ³¨é‡Šï¼ŒæŠŠyesæ”¹ä¸ºno</span><br></code></pre></td></tr></table></figure>
<ol>
<li>æœ€åè¿è¡Œä¸‹é¢å‘½ä»¤å³å¯ã€‚</li>
</ol>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">ln -sf <span class="hljs-regexp">/run/</span>systemd<span class="hljs-regexp">/resolve/</span>resolv.conf <span class="hljs-regexp">/etc/</span>resolv.conf<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
  </entry>
  <entry>
    <title>Rustçš„ä¸€äº›å­¦ä¹ å¿ƒå¾—</title>
    <url>/rust/rust/</url>
    <content><![CDATA[<h1 id="Rust-æ ‡å‡†åº“-trait"><a href="#Rust-æ ‡å‡†åº“-trait" class="headerlink" title="Rust æ ‡å‡†åº“ trait"></a>Rust æ ‡å‡†åº“ trait</h1><p>å‡è®¾æœ‰ä»¥ä¸‹å˜é‡ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">let</span> t = T::new()<br></code></pre></td></tr></table></figure>
<h2 id="impl-From-lt-U-gt-for-T"><a href="#impl-From-lt-U-gt-for-T" class="headerlink" title="impl From&lt;U&gt; for T"></a><code>impl From&lt;U&gt; for T</code></h2><p>å¦‚æœä¸º <code>T</code> å®ç°äº† <code>From&lt;U&gt;</code> åˆ™å¯ä»¥é€šè¿‡ <code>T::from(U)</code> å¾—åˆ° <code>T</code>ã€‚</p>
<p>ä¾‹å¦‚ <code>String</code> å®ç°äº† <code>From&lt;&amp;str&gt;</code>ï¼Œæ‰€ä»¥ <code>String</code> å¯ä»¥ä» <code>&amp;str</code> ç”Ÿæˆã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">let</span> string = <span class="hljs-string">&quot;hello&quot;</span>.to_string();<br><span class="hljs-keyword">let</span> other_string = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">&quot;hello&quot;</span>);<br><br><span class="hljs-built_in">assert_eq!</span>(string, other_string);<br></code></pre></td></tr></table></figure>
<p><code>impl Into&lt;U&gt; for T</code></p>
<p>å¦‚æœä¸º <code>T</code> å®ç°äº† <code>Into&lt;U&gt;</code> åˆ™å¯ä»¥é€šè¿‡ <code>t.into()</code> æ¶ˆè€—è‡ªå·±å¾—åˆ° <code>U</code>ã€‚</p>
<p>ä¾‹å¦‚ <code>String</code> ç±»å‹å®ç°äº† <code>Into&lt;Vec&lt;u8&gt;&gt;</code>ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_hello</span></span>&lt;T: <span class="hljs-built_in">Into</span>&lt;<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-built_in">u8</span>&gt;&gt;&gt;(s: T) &#123;<br>   <span class="hljs-keyword">let</span> bytes = <span class="hljs-string">b&quot;hello&quot;</span>.to_vec();<br>   <span class="hljs-built_in">assert_eq!</span>(bytes, s.into());<br>&#125;<br><br><span class="hljs-keyword">let</span> s = <span class="hljs-string">&quot;hello&quot;</span>.to_string();<br>is_hello(s);<br></code></pre></td></tr></table></figure>
<p>åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œç”¨æ¥æ¥æ”¶å¤šç§ç±»å‹çš„å‚æ•°ï¼Œå¦‚ <code>Into&lt;String&gt;</code> å¯ä»¥åŒæ—¶æ¥æ”¶ <code>String</code> å’Œ <code>&amp;str</code>ã€‚</p>
<h2 id="impl-AsRef-lt-U-gt-for-T"><a href="#impl-AsRef-lt-U-gt-for-T" class="headerlink" title="impl AsRef&lt;U&gt; for T"></a><code>impl AsRef&lt;U&gt; for T</code></h2><p>å¦‚æœä¸º <code>T</code> å®ç°äº† <code>AsRef&lt;U&gt;</code> åˆ™å¯ä»¥é€šè¿‡ <code>t.as_ref()</code> å¾—åˆ° <code>&amp;U</code>ã€‚</p>
<p>æ³¨ï¼š</p>
<ol>
<li>ä¸ <code>Into&lt;U&gt;</code> ä¸åŒçš„æ˜¯ï¼Œ<code>AsRef&lt;U&gt;</code> åªæ˜¯ç±»å‹è½¬æ¢ï¼Œ<code>t</code> å¯¹è±¡æœ¬èº«æ²¡æœ‰è¢«æ¶ˆè€—ï¼›</li>
<li><code>T: AsRef&lt;U&gt;</code> ä¸­çš„ <code>T</code>ï¼Œå¯ä»¥æ¥å— èµ„æºæ‹¥æœ‰è€…ï¼ˆownedï¼‰ç±»å‹ï¼Œå…±äº«å¼•ç”¨ï¼ˆshared referrenceï¼‰ç±»å‹ ï¼Œå¯å˜å¼•ç”¨ï¼ˆmutable referrenceï¼‰ç±»å‹ã€‚</li>
</ol>
<p>ä¾‹å¦‚ <code>String</code> å’Œ <code>&amp;str</code> éƒ½å®ç°äº† <code>AsRef&lt;str&gt;</code>ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_hello</span></span>&lt;T: <span class="hljs-built_in">AsRef</span>&lt;<span class="hljs-built_in">str</span>&gt;&gt;(s: T) &#123;<br>   <span class="hljs-built_in">assert_eq!</span>(<span class="hljs-string">&quot;hello&quot;</span>, s.as_ref());<br>&#125;<br><br><span class="hljs-keyword">let</span> s = <span class="hljs-string">&quot;hello&quot;</span>;<br>is_hello(s);<br><br><span class="hljs-keyword">let</span> s = <span class="hljs-string">&quot;hello&quot;</span>.to_string();<br>is_hello(s);<br></code></pre></td></tr></table></figure>
<h2 id="impl-AsMut-lt-U-gt-for-T"><a href="#impl-AsMut-lt-U-gt-for-T" class="headerlink" title="impl AsMut&lt;U&gt; for T"></a><code>impl AsMut&lt;U&gt; for T</code></h2><p>å¦‚æœä¸º <code>T</code> å®ç°äº† <code>AsRef&lt;U&gt;</code> åˆ™å¯ä»¥é€šè¿‡ <code>t.as_mut()</code> å¾—åˆ° <code>&amp;mut U</code>ã€‚</p>
<h2 id="impl-Borror-lt-U-gt-for-T"><a href="#impl-Borror-lt-U-gt-for-T" class="headerlink" title="impl Borror&lt;U&gt; for T"></a><code>impl Borror&lt;U&gt; for T</code></h2><p>å¦‚æœ <code>T</code> å®ç°äº† <code>Borrow&lt;U&gt;</code>ï¼Œé‚£ä¹ˆï¼Œ<code>t</code> å¯æ‰§è¡Œ <code>.borrow()</code> æ“ä½œï¼Œå³ <code>t.borrow()</code>ã€‚æ“ä½œçš„ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç±»å‹ä¸º <code>&amp;U</code> çš„æ–°å¼•ç”¨ã€‚</p>
<p><code>Borrow</code> å¯ä»¥è®¤ä¸ºæ˜¯ <code>AsRef</code> çš„ä¸¥æ ¼ç‰ˆæœ¬ï¼Œå®ƒå¯¹æ™®é€‚å¼•ç”¨æ“ä½œçš„å‰åç±»å‹ä¹‹é—´é™„åŠ äº†ä¸€äº›å…¶å®ƒé™åˆ¶ã€‚</p>
<p><code>Borrow</code> çš„å‰åç±»å‹ä¹‹é—´è¦æ±‚å¿…é¡»æœ‰å†…éƒ¨ç­‰ä»·æ€§ã€‚ä¸å…·æœ‰è¿™ä¸ªç­‰ä»·æ€§çš„ä¸¤ä¸ªç±»å‹ä¹‹é—´ï¼Œä¸èƒ½å®ç° <code>Borrow</code>ã€‚</p>
<p><code>AsRef</code> æ›´é€šç”¨ï¼Œæ›´æ™®éï¼Œè¦†ç›–ç±»å‹æ›´å¤šï¼Œæ˜¯ <code>Borrow</code> çš„è¶…é›†ã€‚</p>
<p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">use</span> std::borrow::Borrow;<br><br><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">check</span></span>&lt;T: Borrow&lt;<span class="hljs-built_in">str</span>&gt;&gt;(s: T) &#123;<br>    <span class="hljs-built_in">assert_eq!</span>(<span class="hljs-string">&quot;Hello&quot;</span>, s.borrow());<br>&#125;<br><br><span class="hljs-keyword">let</span> s = <span class="hljs-string">&quot;Hello&quot;</span>.to_string();<br><br>check(s);<br><br><span class="hljs-keyword">let</span> s = <span class="hljs-string">&quot;Hello&quot;</span>;<br><br>check(s);<br></code></pre></td></tr></table></figure>
<h2 id="impl-BorrowMut-lt-U-gt-for-T"><a href="#impl-BorrowMut-lt-U-gt-for-T" class="headerlink" title="impl BorrowMut&lt;U&gt; for T"></a><code>impl BorrowMut&lt;U&gt; for T</code></h2><p>å¦‚æœ <code>T</code> å®ç°äº† <code>BorrowMut&lt;U&gt;</code>ï¼Œé‚£ä¹ˆï¼Œ<code>t</code> å¯æ‰§è¡Œ <code>.borrow_mut()</code> æ“ä½œï¼Œå³ <code>t.borrow_mut()</code>ã€‚æ“ä½œçš„ç»“æœæˆ‘ä»¬å¾—åˆ°ç±»å‹ä¸º <code>&amp;mut U</code> çš„ä¸€ä¸ªå¯å˜ï¼ˆmutableï¼‰å¼•ç”¨ã€‚</p>
<h2 id="impl-ToOwned-for-T"><a href="#impl-ToOwned-for-T" class="headerlink" title="impl ToOwned for T"></a><code>impl ToOwned for T</code></h2><p><code>ToOwned</code> ä¸º <code>Clone</code> çš„æ™®é€‚ç‰ˆæœ¬ã€‚å®ƒæä¾›äº† <code>.to_owned()</code> æ–¹æ³•ï¼Œç”¨äºç±»å‹è½¬æ¢ã€‚</p>
<p>æœ‰äº›å®ç°äº† <code>Clone</code> çš„ç±»å‹ <code>T</code> å¯ä»¥ä»å¼•ç”¨çŠ¶æ€å®ä¾‹ <code>&amp;T</code> é€šè¿‡ <code>.clone()</code> æ–¹æ³•ï¼Œç”Ÿæˆå…·æœ‰æ‰€æœ‰æƒçš„ <code>T</code> çš„å®ä¾‹ã€‚ä½†æ˜¯å®ƒåªèƒ½ç”± <code>&amp;T</code> ç”Ÿæˆ <code>T</code>ã€‚è€Œå¯¹äºå…¶å®ƒå½¢å¼çš„å¼•ç”¨ï¼Œ<code>Clone</code> å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚</p>
<p>è€Œ <code>ToOwned</code> trait èƒ½å¤Ÿä»ä»»æ„å¼•ç”¨ç±»å‹å®ä¾‹ï¼Œç”Ÿæˆå…·æœ‰æ‰€æœ‰æƒçš„ç±»å‹å®ä¾‹ã€‚</p>
<h2 id="impl-Deref-for-T"><a href="#impl-Deref-for-T" class="headerlink" title="impl Deref for T"></a><code>impl Deref for T</code></h2><p><code>Deref</code> æ˜¯ <code>deref</code> æ“ä½œç¬¦ <code>*</code> çš„ traitï¼Œæ¯”å¦‚ <code>*v</code>ã€‚</p>
<p>ä¸€èˆ¬ç†è§£ï¼Œ<code>*t</code> æ“ä½œï¼Œæ˜¯ <code>&amp;t</code> çš„åå‘æ“ä½œï¼Œå³è¯•å›¾ç”±èµ„æºçš„å¼•ç”¨è·å–åˆ°èµ„æºçš„æ‹·è´ï¼ˆå¦‚æœèµ„æºç±»å‹å®ç°äº† <code>Copy</code>ï¼‰ï¼Œæˆ–æ‰€æœ‰æƒï¼ˆèµ„æºç±»å‹æ²¡æœ‰å®ç° <code>Copy</code>ï¼‰ã€‚</p>
<p>Rust ä¸­ï¼Œæœ¬æ“ä½œç¬¦è¡Œä¸ºå¯ä»¥é‡è½½ã€‚è¿™ä¹Ÿæ˜¯ Rust æ“ä½œç¬¦çš„åŸºæœ¬ç‰¹ç‚¹ã€‚æœ¬èº«æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ã€‚</p>
<h3 id="å¼ºåˆ¶éšå¼è½¬æ¢ï¼ˆcoercionï¼‰"><a href="#å¼ºåˆ¶éšå¼è½¬æ¢ï¼ˆcoercionï¼‰" class="headerlink" title="å¼ºåˆ¶éšå¼è½¬æ¢ï¼ˆcoercionï¼‰"></a>å¼ºåˆ¶éšå¼è½¬æ¢ï¼ˆcoercionï¼‰</h3><p><code>Deref</code> ç¥å¥‡çš„åœ°æ–¹å¹¶ä¸åœ¨æœ¬èº« <code>è§£å¼•</code> è¿™ä¸ªæ„ä¹‰ä¸Šï¼ŒRust çš„è®¾è®¡è€…åœ¨å®ƒä¹‹ä¸Šé™„åŠ äº†ä¸€ä¸ªç‰¹æ€§ï¼š<code>å¼ºåˆ¶éšå¼è½¬æ¢</code>ï¼Œè¿™æ‰æ˜¯å®ƒç¥å¥‡ä¹‹å¤„ã€‚</p>
<p>è¿™ç§éšå¼è½¬æ¢çš„è§„åˆ™ä¸ºï¼š</p>
<p>ä¸€ä¸ªç±»å‹ä¸º <code>T</code> çš„å¯¹è±¡ <code>t</code>ï¼Œå¦‚æœ <code>T: Deref&lt;Target=U&gt;</code>ï¼Œé‚£ä¹ˆï¼Œç›¸å…³ <code>t</code> çš„æŸä¸ªæ™ºèƒ½æŒ‡é’ˆæˆ–å¼•ç”¨ï¼ˆæ¯”å¦‚ <code>&amp;foo</code>ï¼‰åœ¨åº”ç”¨çš„æ—¶å€™ä¼šè‡ªåŠ¨è½¬æ¢æˆ <code>&amp;U</code>ã€‚</p>
<p>ç²—çœ‹è¿™æ¡è§„åˆ™ï¼Œè²Œä¼¼æœ‰ç‚¹ç±»ä¼¼äº <code>AsRef</code>ï¼Œè€Œè·Ÿ <code>è§£å¼•</code> ä¼¼ä¹é£é©¬ç‰›ä¸ç›¸åŠã€‚å®é™…é‡Œé¢æœ‰äº›ç„å¦™ä¹‹å¤„ã€‚</p>
<p>Rust ç¼–è¯‘å™¨ä¼šåœ¨åš <code>*v</code> æ“ä½œçš„æ—¶å€™ï¼Œè‡ªåŠ¨å…ˆæŠŠ <code>v</code> åšå¼•ç”¨å½’ä¸€åŒ–æ“ä½œï¼Œå³è½¬æ¢æˆå†…éƒ¨é€šç”¨å¼•ç”¨çš„å½¢å¼ <code>&amp;v</code>ï¼Œæ•´ä¸ªè¡¨è¾¾å¼å°±å˜æˆ <code>*&amp;v</code>ã€‚è¿™é‡Œé¢æœ‰ä¸¤ç§æƒ…å†µï¼š</p>
<ol>
<li>æŠŠå…¶å®ƒç±»å‹çš„æŒ‡é’ˆï¼ˆæ¯”å¦‚åœ¨åº“ä¸­å®šä¹‰çš„ï¼Œ<code>Box</code>, <code>Rc</code>, <code>Arc</code>, <code>Cow</code> ç­‰ï¼‰ï¼Œè½¬æˆå†…éƒ¨æ ‡å‡†å½¢å¼ <code>&amp;v</code>ï¼›</li>
<li>æŠŠå¤šé‡ <code>&amp;</code> ï¼ˆæ¯”å¦‚ï¼š<code>&amp;&amp;&amp;&amp;&amp;&amp;&amp;v</code>ï¼‰ï¼Œç®€åŒ–æˆ <code>&amp;v</code>ï¼ˆé€šè¿‡æ’å…¥è¶³å¤Ÿæ•°é‡çš„ <code>*</code> è¿›è¡Œè§£å¼•ï¼‰ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œå®ƒå®é™…ä¸Šåœ¨è§£å¼•ç”¨ä¹‹å‰åšäº†ä¸€ä¸ªå¼•ç”¨çš„å½’ä¸€åŒ–æ“ä½œã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦è½¬å‘¢ï¼Ÿ å› ä¸ºç¼–è¯‘å™¨è®¾è®¡çš„èƒ½åŠ›æ˜¯ï¼Œåªèƒ½å¤Ÿå¯¹ <code>&amp;v</code> è¿™ç§å¼•ç”¨è¿›è¡Œè§£å¼•ç”¨ã€‚å…¶å®ƒå½¢å¼çš„å®ƒä¸è®¤è¯†ï¼Œæ‰€ä»¥è¦åšå¼•ç”¨å½’ä¸€åŒ–æ“ä½œã€‚</p>
<p>ä½¿ç”¨å¼•ç”¨è¿›è¡Œè¿‡æ¸¡ä¹Ÿæ˜¯ä¸ºäº†èƒ½å¤Ÿé˜²æ­¢ä¸å¿…è¦çš„æ‹·è´ã€‚</p>
<p>ä¸‹é¢ä¸¾ä¸€äº›ä¾‹å­ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">foo</span></span>(s: &amp;<span class="hljs-built_in">str</span>) &#123;<br>    <span class="hljs-comment">// borrow a string for a second</span><br>&#125;<br><br><span class="hljs-comment">// String implements Deref&lt;Target=str&gt;</span><br><span class="hljs-keyword">let</span> owned = <span class="hljs-string">&quot;Hello&quot;</span>.to_string();<br><br><span class="hljs-comment">// therefore, this works:</span><br>foo(&amp;owned);<br></code></pre></td></tr></table></figure>
<p>å› ä¸º <code>String</code> å®ç°äº† <code>Deref&lt;Target=str&gt;</code>ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">use</span> std::rc::Rc;<br><br><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">foo</span></span>(s: &amp;<span class="hljs-built_in">str</span>) &#123;<br>    <span class="hljs-comment">// borrow a string for a second</span><br>&#125;<br><br><span class="hljs-comment">// String implements Deref&lt;Target=str&gt;</span><br><span class="hljs-keyword">let</span> owned = <span class="hljs-string">&quot;Hello&quot;</span>.to_string();<br><span class="hljs-keyword">let</span> counted = Rc::new(owned);<br><br><span class="hljs-comment">// therefore, this works:</span><br>foo(&amp;counted);<br></code></pre></td></tr></table></figure>
<p>å› ä¸º <code>Rc&lt;T&gt;</code> å®ç°äº† <code>Deref&lt;Target=T&gt;</code>ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">foo</span></span>(s: &amp;[<span class="hljs-built_in">i32</span>]) &#123;<br>    <span class="hljs-comment">// borrow a slice for a second</span><br>&#125;<br><br><span class="hljs-comment">// Vec&lt;T&gt; implements Deref&lt;Target=[T]&gt;</span><br><span class="hljs-keyword">let</span> owned = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br><br>foo(&amp;owned);<br></code></pre></td></tr></table></figure>
<p>å› ä¸º <code>Vec&lt;T&gt;</code> å®ç°äº† <code>Deref&lt;Target=[T]&gt;</code>ã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Foo</span></span>;<br><br><span class="hljs-keyword">impl</span> Foo &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">foo</span></span>(&amp;<span class="hljs-keyword">self</span>) &#123; <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Foo&quot;</span>); &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> f = &amp;&amp;Foo;<br><br>f.foo();<br>(&amp;f).foo();<br>(&amp;&amp;f).foo();<br>(&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;f).foo();<br></code></pre></td></tr></table></figure>
<p>ä¸Šé¢é‚£å‡ ç§å‡½æ•°çš„è°ƒç”¨ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p>
<p><code>coercion</code> çš„è®¾è®¡ï¼Œæ˜¯ Rust ä¸­ä»…æœ‰çš„ç±»å‹éšå¼è½¬æ¢ï¼Œè®¾è®¡å®ƒçš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†ç®€åŒ–ç¨‹åºçš„ä¹¦å†™ï¼Œè®©ä»£ç ä¸è‡³äºè¿‡äºç¹çã€‚æŠŠäººä»æ— å°½çš„ç±»å‹ç»†èŠ‚ä¸­è§£è„±å‡ºæ¥ï¼Œè®©ä¹¦å†™ Rust ä»£ç å˜æˆä¸€ä»¶å¿«ä¹çš„äº‹æƒ…ã€‚</p>
<h2 id="Cow"><a href="#Cow" class="headerlink" title="Cow"></a><code>Cow</code></h2><p><code>Clone-on-write</code>ï¼Œå³å†™æ—¶å…‹éš†ã€‚æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆã€‚</p>
<p>å®ƒæœ‰ä¸¤ä¸ªå¯é€‰å€¼ï¼š</p>
<ul>
<li><code>Borrowed</code>ï¼Œç”¨äºåŒ…è£¹å¯¹è±¡çš„å¼•ç”¨ï¼ˆé€šç”¨å¼•ç”¨ï¼‰ï¼›</li>
<li><code>Owned</code>ï¼Œç”¨äºåŒ…è£¹å¯¹è±¡çš„æ‰€æœ‰è€…ï¼›</li>
</ul>
<p><code>Cow</code> æä¾›</p>
<ol>
<li>å¯¹æ­¤å¯¹è±¡çš„ä¸å¯å˜è®¿é—®ï¼ˆæ¯”å¦‚å¯ç›´æ¥è°ƒç”¨æ­¤å¯¹è±¡åŸæœ‰çš„ä¸å¯å˜æ–¹æ³•ï¼‰ï¼›</li>
<li>å¦‚æœé‡åˆ°éœ€è¦ä¿®æ”¹æ­¤å¯¹è±¡ï¼Œæˆ–è€…éœ€è¦è·å¾—æ­¤å¯¹è±¡çš„æ‰€æœ‰æƒçš„æƒ…å†µï¼Œ<code>Cow</code> æä¾›æ–¹æ³•åšå…‹éš†å¤„ç†ï¼Œå¹¶é¿å…å¤šæ¬¡é‡å¤å…‹éš†ã€‚</li>
</ol>
<p><code>Cow</code> çš„è®¾è®¡ç›®çš„æ˜¯æé«˜æ€§èƒ½ï¼ˆå‡å°‘å¤åˆ¶ï¼‰åŒæ—¶å¢åŠ çµæ´»æ€§ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸šåŠ¡åœºæ™¯éƒ½æ˜¯è¯»å¤šå†™å°‘ã€‚åˆ©ç”¨ <code>Cow</code>ï¼Œå¯ä»¥ç”¨ç»Ÿä¸€ï¼Œè§„èŒƒçš„å½¢å¼å®ç°ï¼Œéœ€è¦å†™çš„æ—¶å€™æ‰åšä¸€æ¬¡å¯¹è±¡å¤åˆ¶ã€‚è¿™æ ·å°±å¯èƒ½ä¼šå¤§å¤§å‡å°‘å¤åˆ¶çš„æ¬¡æ•°ã€‚</p>
<p>å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹éœ€è¦æŒæ¡ï¼š</p>
<ol>
<li><code>Cow&lt;T&gt;</code> èƒ½ç›´æ¥è°ƒç”¨ <code>T</code> çš„ä¸å¯å˜æ–¹æ³•ï¼Œå› ä¸º <code>Cow</code> è¿™ä¸ªæšä¸¾ï¼Œå®ç°äº† <code>Deref</code>ï¼›</li>
<li>åœ¨éœ€è¦å†™ <code>T</code>çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ <code>.to_mut()</code> æ–¹æ³•å¾—åˆ°ä¸€ä¸ªå…·æœ‰æ‰€æœ‰æƒçš„å€¼çš„å¯å˜å€Ÿç”¨ï¼›<ol>
<li>æ³¨æ„ï¼Œè°ƒç”¨ <code>.to_mut()</code> ä¸ä¸€å®šä¼šäº§ç”Ÿå…‹éš†ï¼›</li>
<li>åœ¨å·²ç»å…·æœ‰æ‰€æœ‰æƒçš„æƒ…å†µä¸‹ï¼Œè°ƒç”¨ <code>.to_mut()</code> æœ‰æ•ˆï¼Œä½†æ˜¯ä¸ä¼šäº§ç”Ÿæ–°çš„å…‹éš†ï¼›</li>
<li>å¤šæ¬¡è°ƒç”¨ <code>.to_mut()</code> åªä¼šäº§ç”Ÿä¸€æ¬¡å…‹éš†ã€‚</li>
</ol>
</li>
<li>åœ¨éœ€è¦å†™ <code>T</code> çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ <code>.into_owned()</code> åˆ›å»ºæ–°çš„æ‹¥æœ‰æ‰€æœ‰æƒçš„å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹å¾€å¾€æ„å‘³ç€å†…å­˜æ‹·è´å¹¶åˆ›å»ºæ–°å¯¹è±¡ï¼›<ol>
<li>å¦‚æœä¹‹å‰ <code>Cow</code> ä¸­çš„å€¼æ˜¯å€Ÿç”¨çŠ¶æ€ï¼Œè°ƒç”¨æ­¤æ“ä½œå°†æ‰§è¡Œå…‹éš†ï¼›</li>
<li>æœ¬æ–¹æ³•ï¼Œå‚æ•°æ˜¯<code>self</code>ç±»å‹ï¼Œå®ƒä¼šâ€œåƒæ‰â€åŸå…ˆçš„é‚£ä¸ªå¯¹è±¡ï¼Œè°ƒç”¨ä¹‹ååŸå…ˆçš„å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå°±æˆªæ­¢äº†ï¼Œåœ¨ <code>Cow</code> ä¸Šä¸èƒ½è°ƒç”¨å¤šæ¬¡ï¼›</li>
</ol>
</li>
</ol>
<h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p><code>.to_mut()</code> ä¸¾ä¾‹</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">use</span> std::borrow::Cow;<br><br><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> cow: Cow&lt;[_]&gt; = Cow::Owned(<span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);<br><br><span class="hljs-keyword">let</span> hello = cow.to_mut();<br><br><span class="hljs-built_in">assert_eq!</span>(hello, &amp;[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);<br></code></pre></td></tr></table></figure>
<p><code>.into_owned()</code> ä¸¾ä¾‹</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">use</span> std::borrow::Cow;<br><br><span class="hljs-keyword">let</span> cow: Cow&lt;[_]&gt; = Cow::Owned(<span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);<br><br><span class="hljs-keyword">let</span> hello = cow.into_owned();<br><br><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], hello);<br></code></pre></td></tr></table></figure>
<p>ç»¼åˆä¸¾ä¾‹</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">use</span> std::borrow::Cow;<br><br><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">abs_all</span></span>(input: &amp;<span class="hljs-keyword">mut</span> Cow&lt;[<span class="hljs-built_in">i32</span>]&gt;) &#123;<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..input.len() &#123;<br>        <span class="hljs-keyword">let</span> v = input[i];<br>        <span class="hljs-keyword">if</span> v &lt; <span class="hljs-number">0</span> &#123;<br>            <span class="hljs-comment">// clones into a vector the first time (if not already owned)</span><br>            input.to_mut()[i] = -v;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="æ›´å¤šçš„ä¾‹å­"><a href="#æ›´å¤šçš„ä¾‹å­" class="headerlink" title="æ›´å¤šçš„ä¾‹å­"></a>æ›´å¤šçš„ä¾‹å­</h3><p>é¢˜ç›®ï¼šå†™ä¸€ä¸ªå‡½æ•°ï¼Œè¿‡æ»¤æ‰è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç©ºæ ¼å­—ç¬¦ï¼Œå¹¶è¿”å›è¿‡æ»¤åçš„å­—ç¬¦ä¸²ã€‚</p>
<p>å¯¹è¿™ä¸ªç®€å•çš„é—®é¢˜ï¼Œä¸ç”¨æ€è€ƒï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å¾ˆå¿«å†™å‡ºä»£ç ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">remove_spaces</span></span>(input: &amp;<span class="hljs-built_in">str</span>) -&gt; <span class="hljs-built_in">String</span> &#123;<br>   <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> buf = <span class="hljs-built_in">String</span>::with_capacity(input.len());<br><br>   <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> input.chars() &#123;<br>      <span class="hljs-keyword">if</span> c != <span class="hljs-string">&#x27; &#x27;</span> &#123;<br>         buf.push(c);<br>      &#125;<br>   &#125;<br><br>   buf<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è®¾è®¡å‡½æ•°è¾“å…¥å‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šåœé¡¿ä¸€ä¸‹ï¼Œè¿™é‡Œï¼Œç”¨ <code>&amp;str</code> å¥½å‘¢ï¼Œè¿˜æ˜¯ <code>String</code> å¥½å‘¢ï¼Ÿæ€è€ƒä¸€ç•ªï¼Œä»æ€§èƒ½ä¸Šè€ƒè™‘ï¼Œæœ‰å¦‚ä¸‹ç»“è®ºï¼š</p>
<ol>
<li>å¦‚æœä½¿ç”¨ <code>String</code> åˆ™å¤–éƒ¨åœ¨è°ƒç”¨æ­¤å‡½æ•°çš„æ—¶å€™ï¼Œ<ol>
<li>å¦‚æœå¤–éƒ¨çš„å­—ç¬¦ä¸²æ˜¯ <code>&amp;str</code>ï¼Œé‚£ä¹ˆï¼Œå®ƒéœ€è¦åšä¸€æ¬¡å…‹éš†ï¼Œæ‰èƒ½è°ƒç”¨æ­¤å‡½æ•°ï¼›</li>
<li>å¦‚æœå¤–éƒ¨çš„å­—ç¬¦ä¸²æ˜¯ <code>String</code>ï¼Œé‚£ä¹ˆï¼Œå®ƒä¸éœ€è¦åšå…‹éš†ï¼Œå°±å¯ä»¥è°ƒç”¨æ­¤å‡½æ•°ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦è°ƒç”¨åï¼Œå¤–éƒ¨é‚£ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰æƒå°±è¢« <code>move</code> åˆ°æ­¤å‡½æ•°ä¸­äº†ï¼Œå¤–éƒ¨çš„åç»­ä»£ç å°†æ— æ³•å†ä½¿ç”¨åŸå­—ç¬¦ä¸²ã€‚</li>
</ol>
</li>
<li>å¦‚æœä½¿ç”¨ <code>&amp;str</code>ï¼Œåˆ™ä¸å­˜åœ¨ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ã€‚ä½†å¯èƒ½ä¼šé‡åˆ°ç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜ï¼Œéœ€è¦æ³¨æ„ã€‚</li>
</ol>
<p>ç»§ç»­åˆ†æä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œåœ¨å‡½æ•°ä½“å†…ï¼Œåšäº†ä¸€æ¬¡æ–°å­—ç¬¦ä¸²å¯¹è±¡çš„ç”Ÿæˆå’Œæ‹·è´ã€‚</p>
<p>è®©æˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€ä¸‹ä¸šåŠ¡éœ€æ±‚ã€‚æœ€åçš„æƒ…å†µä¸‹ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­æ²¡æœ‰ç©ºç™½å­—ç¬¦ï¼Œé‚£æœ€å¥½æ˜¯ç›´æ¥åŸæ ·è¿”å›ã€‚è¿™ç§æƒ…å†µåšè¿™æ ·ä¸€æ¬¡å¯¹è±¡çš„æ‹·è´ï¼Œå®Œå…¨å°±æ˜¯æµªè´¹äº†ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å¿ƒæƒ³æ”¹è¿›è¿™ä¸ªç®—æ³•ã€‚å¾ˆå¿«ï¼Œåˆé‡åˆ°äº†å¦ä¸€ä¸ªé—®é¢˜ï¼Œè¿”å›å€¼æ˜¯ <code>String</code> çš„å˜›ï¼Œæˆ‘ä¸è®ºæ€æ ·ï¼Œè¦æŠŠ <code>&amp;str</code> è½¬æ¢æˆ <code>String</code> è¿”å›ï¼Œå§‹ç»ˆéƒ½è¦ç»å†ä¸€æ¬¡å¤åˆ¶ã€‚äºæ˜¯æˆ‘ä»¬å¿«è¦æ”¾å¼ƒäº†ã€‚</p>
<p>å¥½å§ï¼Œ<code>Cow</code> å›è¿™æ—¶å‡ºé©¬äº†ã€‚å†™å‡ºäº†å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">use</span> std::borrow::Cow;<br><br><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">remove_spaces</span></span>&lt;<span class="hljs-symbol">&#x27;a</span>&gt;(input: &amp;<span class="hljs-symbol">&#x27;a</span> <span class="hljs-built_in">str</span>) -&gt; Cow&lt;<span class="hljs-symbol">&#x27;a</span>, <span class="hljs-built_in">str</span>&gt; &#123;<br>    <span class="hljs-keyword">if</span> input.contains(<span class="hljs-string">&#x27; &#x27;</span>) &#123;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> buf = <span class="hljs-built_in">String</span>::with_capacity(input.len());<br><br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> input.chars() &#123;<br>            <span class="hljs-keyword">if</span> c != <span class="hljs-string">&#x27; &#x27;</span> &#123;<br>                buf.push(c);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> Cow::Owned(buf);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> Cow::Borrowed(input);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å®Œç¾è§£å†³äº†ä¸šåŠ¡é€»è¾‘ä¸è¿”å›å€¼ç±»å‹å†²çªçš„é—®é¢˜ã€‚æœ¬ä¾‹å¯ç»†ç»†å“å‘³ã€‚</p>
<p>å¤–éƒ¨ç¨‹åºï¼Œæ‹¿åˆ°è¿™ä¸ª <code>Cow</code> è¿”å›å€¼åï¼ŒæŒ‰ç…§æˆ‘ä»¬ä¸Šæ–‡æè¿°çš„ <code>Cow</code> çš„ç‰¹æ€§ä½¿ç”¨å°±å¥½äº†ã€‚</p>
<h2 id="Send-å’Œ-Sync"><a href="#Send-å’Œ-Sync" class="headerlink" title="Send å’Œ Sync"></a><code>Send</code> å’Œ <code>Sync</code></h2><p><code>std::marker</code> æ¨¡å—ä¸­ï¼Œæœ‰ä¸¤ä¸ª traitï¼š<code>Send</code> å’Œ <code>Sync</code>ï¼Œå®ƒä»¬ä¸å¤šçº¿ç¨‹å®‰å…¨ç›¸å…³ã€‚</p>
<p>æ ‡è®°ä¸º <code>marker trait</code> çš„ traitï¼Œå®ƒå®é™…å°±æ˜¯ä¸€ç§çº¦å®šï¼Œæ²¡æœ‰æ–¹æ³•çš„å®šä¹‰ï¼Œä¹Ÿæ²¡æœ‰å…³è”å…ƒç´ ï¼ˆassociated itemsï¼‰ã€‚ä»…ä»…æ˜¯ä¸€ç§çº¦å®šï¼Œå®ç°äº†å®ƒçš„ç±»å‹å¿…é¡»æ»¡è¶³è¿™ç§çº¦å®šã€‚ä¸€ç§ç±»å‹æ˜¯å¦åŠ ä¸Šè¿™ç§çº¦å®šï¼Œè¦ä¹ˆæ˜¯ç¼–è¯‘å™¨çš„è¡Œä¸ºï¼Œè¦ä¹ˆæ˜¯äººå·¥æ‰‹åŠ¨çš„è¡Œä¸ºã€‚</p>
<p><code>Send</code> å’Œ <code>Sync</code> åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ˆé’ˆå¯¹ Rust çš„åŸºç¡€ç±»å‹å’Œ std ä¸­çš„å¤§éƒ¨åˆ†ç±»å‹ï¼‰ï¼Œä¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ¨å¯¼å‡ºæ¥ã€‚å¯¹äºä¸èƒ½ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ¨å¯¼å‡ºæ¥çš„ç±»å‹ï¼Œè¦ä½¿å®ƒä»¬å…·æœ‰ <code>Send</code> æˆ– <code>Sync</code> çš„çº¦å®šï¼Œå¯ä»¥ç”±äººæ‰‹åŠ¨å®ç°ã€‚å®ç°çš„æ—¶å€™ï¼Œå¿…é¡»ä½¿ç”¨ <code>unsafe</code> å‰ç¼€ï¼Œå› ä¸º Rust é»˜è®¤ä¸ä¿¡ä»»ç¨‹åºå‘˜ï¼Œç”±ç¨‹åºå‘˜è‡ªå·±æ§åˆ¶çš„ä¸œè¥¿ï¼Œç»Ÿç»Ÿæ ‡è®°ä¸º <code>unsafe</code>ï¼Œå‡ºäº†é—®é¢˜ï¼ˆæ¯”å¦‚ï¼ŒæŠŠä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„å¯¹è±¡åŠ ä¸Š <code>Sync</code> çº¦å®šï¼‰ç”±ç¨‹åºå‘˜è‡ªè¡Œè´Ÿè´£ã€‚</p>
<p>å®ƒä»¬çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p>å¦‚æœ <code>T: Send</code>ï¼Œé‚£ä¹ˆå°† <code>T</code> ä¼ åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä¸­æ—¶ï¼ˆæŒ‰å€¼ä¼ é€ï¼‰ï¼Œä¸ä¼šå¯¼è‡´æ•°æ®ç«äº‰æˆ–å…¶å®ƒä¸å®‰å…¨æƒ…å†µã€‚</p>
<ol>
<li><code>Send</code> æ˜¯å¯¹è±¡å¯ä»¥å®‰å…¨å‘é€åˆ°å¦ä¸€ä¸ªæ‰§è¡Œä½“ä¸­ï¼›</li>
<li><code>Send</code> ä½¿è¢«å‘é€å¯¹è±¡å¯ä»¥å’Œäº§ç”Ÿå®ƒçš„çº¿ç¨‹è§£è€¦ï¼Œé˜²æ­¢åŸçº¿ç¨‹å°†æ­¤èµ„æºé‡Šæ”¾åï¼Œåœ¨ç›®æ ‡çº¿ç¨‹ä¸­ä½¿ç”¨å‡ºé”™ï¼ˆuse after freeï¼‰ã€‚</li>
</ol>
<p>å¦‚æœ <code>T: Sync</code>ï¼Œé‚£ä¹ˆå°† <code>&amp;T</code> ä¼ åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä¸­æ—¶ï¼Œä¸ä¼šå¯¼è‡´æ•°æ®ç«äº‰æˆ–å…¶å®ƒä¸å®‰å…¨æƒ…å†µã€‚</p>
<ol>
<li><code>Sync</code> æ˜¯å¯ä»¥è¢«åŒæ—¶å¤šä¸ªæ‰§è¡Œä½“è®¿é—®è€Œä¸å‡ºé”™ï¼›</li>
<li><code>Sync</code> é˜²æ­¢çš„æ˜¯ç«äº‰ï¼›</li>
</ol>
<p>æ¨è®ºï¼š</p>
<ol>
<li><code>T: Sync</code> æ„å‘³ç€ <code>&amp;T: Send</code>ï¼›</li>
<li><code>Sync + Copy = Send</code>ï¼›</li>
<li>å½“ <code>T: Send</code> æ—¶ï¼Œå¯æ¨å¯¼å‡º <code>&amp;mut T: Send</code>ï¼›</li>
<li>å½“ <code>T: Sync</code> æ—¶ï¼Œå¯æ¨å¯¼å‡º <code>&amp;mut T: Sync</code>ï¼›</li>
<li>å½“ <code>&amp;mut T: Send</code> æ—¶ï¼Œä¸èƒ½æ¨å¯¼å‡º <code>T: Send</code>ï¼›</li>
</ol>
<p>ï¼ˆæ³¨ï¼š<code>T</code>, <code>&amp;T</code>, <code>&amp;mut T</code>ï¼Œ<code>Box&lt;T&gt;</code> ç­‰éƒ½æ˜¯ä¸åŒçš„ç±»å‹ï¼‰</p>
<p>å…·ä½“çš„ç±»å‹ï¼š</p>
<ol>
<li>åŸå§‹ç±»å‹ï¼ˆæ¯”å¦‚ï¼š u8, f64ï¼‰ï¼Œéƒ½æ˜¯ <code>Sync</code>ï¼Œéƒ½æ˜¯ <code>Copy</code>ï¼Œå› æ­¤éƒ½æ˜¯ <code>Send</code>ï¼›</li>
<li>åªåŒ…å«åŸå§‹ç±»å‹çš„å¤åˆç±»å‹ï¼Œéƒ½æ˜¯ <code>Sync</code>ï¼Œéƒ½æ˜¯ <code>Copy</code>ï¼Œå› æ­¤éƒ½æ˜¯ <code>Send</code>ï¼›</li>
<li>å½“ <code>T: Sync</code>ï¼Œ<code>Box&lt;T&gt;</code>, <code>Vec&lt;T&gt;</code> ç­‰é›†åˆç±»å‹æ˜¯ <code>Sync</code>ï¼›</li>
<li>å…·æœ‰å†…éƒ¨å¯å˜æ€§çš„çš„æŒ‡é’ˆï¼Œä¸æ˜¯ <code>Sync</code> çš„ï¼Œæ¯”å¦‚ <code>Cell</code>, <code>RefCell</code>, <code>UnsafeCell</code>ï¼›</li>
<li><code>Rc</code> ä¸æ˜¯ <code>Sync</code>ã€‚å› ä¸ºåªè¦ä¸€åš <code>&amp;Rc&lt;T&gt;</code> æ“ä½œï¼Œå°±ä¼šå…‹éš†ä¸€ä¸ªæ–°å¼•ç”¨ï¼Œå®ƒä¼šä»¥éåŸå­æ€§çš„æ–¹å¼ä¿®æ”¹å¼•ç”¨è®¡æ•°ï¼Œæ‰€ä»¥æ˜¯ä¸å®‰å…¨çš„ï¼›</li>
<li>è¢« <code>Mutex</code> å’Œ <code>RWLock</code> é”ä½çš„ç±»å‹ <code>T: Send</code>ï¼Œæ˜¯ <code>Sync</code> çš„ï¼›</li>
<li>åŸå§‹æŒ‡é’ˆï¼ˆ<code>*mut</code>, <code>*const</code>ï¼‰æ—¢ä¸æ˜¯ <code>Send</code> ä¹Ÿä¸æ˜¯ <code>Sync</code>ï¼›</li>
</ol>
<p>Rust æ­£æ˜¯é€šè¿‡è¿™ä¸¤å¤§æ­¦å™¨ï¼š<code>æ‰€æœ‰æƒå’Œç”Ÿå‘½å‘¨æœŸ</code> + <code>Send å’Œ Sync</code>ï¼ˆæœ¬è´¨ä¸Šä¸ºç±»å‹ç³»ç»Ÿï¼‰æ¥ä¸ºå¹¶å‘ç¼–ç¨‹æä¾›äº†å®‰å…¨å¯é çš„åŸºç¡€è®¾æ–½ã€‚ä½¿å¾—ç¨‹åºå‘˜å¯ä»¥æ”¾å¿ƒåœ¨å…¶ä¸Šæ„å»ºç¨³å¥çš„å¹¶å‘æ¨¡å‹ã€‚è¿™ä¹Ÿæ­£æ˜¯ Rust çš„æ ¸å¿ƒè®¾è®¡è§‚çš„ä½“ç°ï¼šå†…æ ¸åªæä¾›æœ€åŸºç¡€çš„åŸè¯­ï¼ŒçœŸæ­£çš„å®ç°èƒ½åˆ†ç¦»å‡ºå»å°±åˆ†ç¦»å‡ºå»ã€‚å¹¶å‘ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://github.com/rustcc/RustPrimer">https://github.com/rustcc/RustPrimer</a></li>
</ol>
]]></content>
      <categories>
        <category>rust</category>
      </categories>
      <tags>
        <tag>rust</tag>
      </tags>
  </entry>
</search>
